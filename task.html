<html>

<head>
  <title>Embedded Style Sample</title>
  <link rel="stylesheet" type="text/css" href="task.css" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.10.20/datatables.min.css" />

  <script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.20/datatables.min.js"></script>

</head>

<body>
  <div class="container">
    <div class="form-group">
      <div class="row">
        <form id="myForm" name="myForm">
          <fieldset class="mtop3">
            <legend>Personal Details:</legend>
            <div class="col-lg-6">
              <label for="fname">First name:</label>
              <input type="text" id="fname" name="fname" value="John" class="form-control">
            </div>
            <div class="col-lg-6">
              <label for="lname">Last name:</label>
              <input type="text" id="lname" name="lname" value="Doe" class="form-control">
            </div>
            <div class="col-lg-6 mtop1">
              <label for="lname">DOB:</label>
              <input type="date" id="dob" name="dob" value="" class="form-control">
            </div>
            <div class="col-lg-6 mtop1">
              <label for="lname">Gender:</label>
              <select id="gender" class="form-control">
                <option value="m">Male</option>
                <option value="f">Female</option>
              </select>
            </div>
            <div id="title" class="col-lg-6 mtop1">
              <label for="lname">Title:</label>
              <select class="form-control">
                <option value="Mr">Mr.</option>
                <option value="Mrs">Mrs.</option>
                <option value="Ms">Ms.</option>
              </select>
            </div>
          </fieldset>
          <fieldset class="mtop3">
            <legend>Address:</legend>
            <div class="col-lg-6">
              <label for="fname">Type:</label>
              <!-- <input type="text" id="fname" name="fname" value="John" class="form-control"> -->
              <select class="form-control" id="addressType">
                <option value=' residential'>Residential</option>
                <option value=" office">Office</option>
              </select>
            </div>
            <div class="col-lg-6">
              <label for="lname">number:</label>
              <input type="number" id="dno" name="lname" value="" class="form-control" min="0" max="999999999">
            </div>
            <div class="col-lg-6 mtop1">
              <label for="lname">Street:</label>
              <input type="text" id="streetName" name="dob" value="" class="form-control">
            </div>
            <div class="col-lg-6 mtop1">
              <label for="lname">Unit:</label>
              <input type="text" id="unit" name="gender" value="" class="form-control">
            </div>
            <div class="col-lg-6 mtop1">
              <label for="lname">City:</label>
              <input type="text" id="city" name="title" value="" class="form-control">
            </div>
            <div class="col-lg-6 mtop1">
              <label for="lname">State:</label>
              <input type="text" id="state" name="title" value="" class="form-control">
            </div>
            <div class="col-lg-6 mtop1">
              <label for="lname">ZipCode:</label>
              <input type="text" id="zipCode" name="title" value="" class="form-control">
            </div>
          </fieldset>
          <fieldset class="mtop3">
            <legend>Communication:</legend>
            <div class="col-lg-6 mtop1">
              <label for="email1">Email:</label>
              <input type="email" id="email1" name="email1" value="" class="form-control" min="0" max="999999999">
              <div class="form-check mtop1">
                <input type="checkbox" class="form-check-input" id="exampleCheck1">
                <label class="form-check-label" for="exampleCheck1">Preffered </label>
              </div>
            </div>
            <div class="col-lg-6 mtop1">
              <label for="mobile">Mobile:</label>
              <input type="number" id="mobile" name="mobile" value="" class="form-control" min="0" max="999999999">
              <div class="form-check mtop1">
                <input type="checkbox" class="form-check-input" id="exampleCheck1">
                <label class="form-check-label" for="exampleCheck1">Preffered </label>
              </div>
            </div>
          </fieldset>
          <input type="submit" class="btn btn-primary pull-right" value="Submit" id="submit">
        </form>
        <br>
        <br>

        <div class="mtop3">
          <table id="contactsTable" class="table table-bordered" style="width:100%">
            <thead>
              <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Contact Number</th>
                <th>City</th>
                <th>Edit</th>
                <th>Delete</th>
              </tr>
            </thead>
          </table>
        </div>
      </div>
    </div>
  </div>
</body>
<script>
  $("#myForm").submit(function () {
    // alert("submitted");
    const resoultJson = {
      "Identification": {
        "FirstName": $('#fname').val(),
        "LastName": $('#lname').val(),
        "DOB": $('#dob').val(),
        "Gender": $('#gender').val(),
        "Title": $('#title').val(),
      },
      "Address": [{
        "type ": $('#addressType').val(),
        "number": $('#dno').val(),
        "street": $('#streetName').val(),
        "Unit": $('#unit').val(),
        "City": $('#city').val(),
        "State": $('#state').val(),
        "zipcode": $('#zipCode').val(),
      }],
      "Communication": [{
        "type": "email",
        "value": $('#email1').val(),
        "preferred": $('#fname').val() ? $('#fname').val() : !($('#fname').val())
      },
      {
        "type": "cell",
        "value": $('#mobile').val(),
        "preferred": $('#fname').val() ? $('#fname').val() : !($('#fname').val())
      }
      ]
    }
    const url = 'https://localhost:4200/api/createConstact'
    $.ajax({
      url: 'url',
      type: 'post',
      success: function (result) {
        $('#example').append(result);
      },
      error: function (error) { }
    })
  })

  var res = $('#contactsTable').DataTable({
    "ajax": {
      "url": '/getContacts',
      "type": "get",
      "datatype": "json"
    },
    "columns": [
      { "data": "Name", "autoWidth": true },
      { "data": "Email", "autoWidth": true },
      { "data": "Contact Number", "autoWidth": true },
      { "data": "City", "autoWidth": true },
      {
        "data": function (data) {
          return '<a id="editLnk" href="/edit/' + data + '">Edit</a>';
        }
      },
      {
        "data": function (data) {
          return '<a id="delLnk" href="/delete/' + data + '">Delete</a>';
        }
      }
    ]
  })


  $('.table').on('click', 'a.edit', function (e) {
    e.preventDefault();
    OpenPopup($(this).attr('href'));
  })
  function OpenPopup(pageUrl) {
    var $pageContent = $('<div/>');
    $pageContent.load(pageUrl, function () {
      $.validator.unobtrusive.parse('form');

    });
  }
  $dialog = $('<div class="popupWindow" style="overflow:auto"></div>')
    .html($pageContent)
    .dialog({
      draggable: false,
      autoOpen: false,
      resizable: false,
      model: true,
      title: 'Popup Dialog',
      height: 550,
      width: 600,
      close: function () {
        $dialog.dialog('destroy').remove();
      }
    })

  $('.popupWindow').on('submit', '#contactForm', function (e) {
    var url = $('#contactForm')[0].action;
    $.ajax({
      type: "POST",
      url: url,
      data: $('#contactForm').serialize(),
      success: function (data) {
        if (data.status) {
          $dialog.dialog('close');
          res.ajax.reload();
        }
      }
    })

    e.preventDefault();
  })
  $dialog.dialog('open');
</script>

</html>